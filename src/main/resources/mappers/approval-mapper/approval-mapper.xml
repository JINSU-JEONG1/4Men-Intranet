<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 해당 파일에 모든 쿼리문을 작성 -->
<mapper namespace="approvalMapper">

	<resultMap type="kh.study.intranet.approval.vo.ApprovalVO" id="approval">
		<id column="APP_SEQ" 		property="appSeq"/>
		<result column="APP_WRITE_DATE" 		property="appWriteDate"/>
		<result column="FIRST_TIME_APPROVER" 		property="firstTimeApprover"/>
		<result column="INTERMIDIATE_APPROVER" 		property="intermidiateApprover"/>
		<result column="FINAL_APPROVER" 		property="finalApprover"/>
		<result column="APP_CHECK_DATE" 		property="appCheckDate"/>
		<result column="APP_RESON" 		property="appReson"/>
		<result column="APP_ORIGIN_FILENAME" 		property="appOriginFilename"/>
		<result column="APP_REFILE_FILENAME" 		property="appRefileFilename"/>
		<result column="APP_WRITER_EMP_NUM" 		property="appWriterEmpNum"/>
		<result column="APP_CHECK_PROGRESS" 		property="appCheckProgress"/>
		<result column="APP_CATE_CODE" 		property="appCateCode"/>
	</resultMap>
	
	<resultMap type="kh.study.intranet.emp.vo.EmpVO" id="emp">
		<id column="USER_ID" 		property="userId"/>
		<result column="USER_PW" 		property="userPw"/>
		<result column="EMP_NUM" 		property="empNum"/>
		<result column="EMP_NAME" 		property="empName"/>
		<result column="EMP_GENDER" 		property="empGender"/>
		<result column="EMP_BIRTHDAY" 		property="empBirthDay"/>
		<result column="EMP_TELL" 		property="empTell"/>
		<result column="EMP_ADDR" 		property="empAddr"/>
		<result column="EMP_DETAIL_ADDR" 		property="empDetailAddr"/>
		<result column="EMP_EMAIL" 		property="empEmail"/>
		<result column="DEPT_CODE" 		property="deptCode"/>
		<result column="DEPT_NAME" 		property="deptName"/>
		<result column="EMP_ROLE" 		property="empRole"/>
		<result column="EMP_PICTURE_ORIGIN_NAME" 		property="empPictureOriginName"/>
		<result column="EMP_PICTURE_REFILE_NAME" 		property="empPictureRefileName"/>
		<result column="EMP_HIRE_DATE" 		property="empHireDate"/>
	</resultMap>
	
	
	<resultMap type="kh.study.intranet.approval.vo.VacationVO" id="vacation">
		<id column="VACATION_SEQ" 		property="vacationSeq"/>
		<result column="VACATION_APP_SEQ" 		property="vacationAppSeq"/>
		<result column="VACATION_CONTENT" 		property="vacationContent"/>
		<result column="VACATION_STATUS" 		property="vacationStatus"/>
		<result column="VACATION_PRESENT" 		property="vacationPresent"/>
		<result column="VACATION_STRAT_DATE" 		property="vacationStratDate"/>
		<result column="VACATION_END_DATE" 		property="vacationEndDate"/>
		<result column="DEPT_CODE" 		property="deptCode"/>
		<result column="USER_ID" 		property="userId"/>
		<result column="APP_CATE_CODE" 		property="appCateCode"/>
  		<association property="deptVO" resultMap="empMapper.dept"/>
	</resultMap>
	
	<select id="getAppSeq" resultMap="approval">
		SELECT (SELECT 'APP_'||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(APP_SEQ, 5))), 0) + 1, 3, 0) FROM APPROVAL) APP_SEQ
        ,TO_CHAR(SYSDATE,'YYYY-MM-DD') AS APP_WRITE_DATE
		FROM DUAL
		
	</select>
	
	<select id="selectAppEmp" resultMap="emp">
		SELECT EMP_NAME
			, EMP.DEPT_NAME
		FROM EMP, DEPT
		WHERE EMP.DEPT_CODE = DEPT.DEPT_CODE
		AND USER_ID = #{userId}
	</select>
	
	<!-- <select id="" resultMap="">
		
		<if test="fromDate != null and !fromDate.equals('')">
			AND TO_CHAR(REG_DATE, 'YYYY-MM-DD') &gt;= #{fromDate}
		</if>
		<if test="toDate != null and !toDate.equals('')">
			AND TO_CHAR(REG_DATE, 'YYYY-MM-DD') &lt;= #{toDate}
		</if>		
		
	</select> -->
	
	
	
</mapper>



